
       _               _              
   ___| |__   ___  ___| | _______   __
  / __| '_ \ / _ \/ __| |/ / _ \ \ / /
 | (__| | | |  __/ (__|   < (_) \ V / 
  \___|_| |_|\___|\___|_|\_\___/ \_/  
                                      
By bridgecrew.io | version: 2.3.240 

terraform scan results:

Passed checks: 43, Failed checks: 46, Skipped checks: 0

Check: CKV_AWS_41: "Ensure no hard coded AWS access key and secret key exists in provider"
	PASSED for resource: aws.default
	File: /main.tf:12-15
	Guide: https://docs.bridgecrew.io/docs/bc_aws_secrets_5
Check: CKV_AWS_168: "Ensure SQS queue policy is not public by only allowing specific services or principals to access it"
	PASSED for resource: aws_sqs_queue.ingest_event_dlq
	File: /main.tf:38-40
	Guide: https://docs.bridgecrew.io/docs/ensure-sqs-queue-policy-is-not-public-by-only-allowing-specific-services-or-principals-to-access-it
Check: CKV_AWS_116: "Ensure that AWS Lambda function is configured for a Dead Letter Queue(DLQ)"
	PASSED for resource: aws_lambda_function.ingest_event
	File: /main.tf:42-64
	Guide: https://docs.bridgecrew.io/docs/ensure-that-aws-lambda-function-is-configured-for-a-dead-letter-queue-dlq
Check: CKV_AWS_45: "Ensure no hard-coded secrets exist in lambda environment"
	PASSED for resource: aws_lambda_function.ingest_event
	File: /main.tf:42-64
	Guide: https://docs.bridgecrew.io/docs/bc_aws_secrets_3
Check: CKV_AWS_50: "X-ray tracing is enabled for Lambda"
	PASSED for resource: aws_lambda_function.ingest_event
	File: /main.tf:42-64
	Guide: https://docs.bridgecrew.io/docs/bc_aws_serverless_4
Check: CKV_AWS_258: "Ensure that Lambda function URLs AuthType is not None"
	PASSED for resource: aws_lambda_function_url.lambda_url
	File: /main.tf:66-69
	Guide: https://docs.bridgecrew.io/docs/ensure-aws-authtype-for-your-lambda-function-urls-is-defined
Check: CKV_AWS_168: "Ensure SQS queue policy is not public by only allowing specific services or principals to access it"
	PASSED for resource: aws_sqs_queue.store_event_to_s3_dlq
	File: /main.tf:71-73
	Guide: https://docs.bridgecrew.io/docs/ensure-sqs-queue-policy-is-not-public-by-only-allowing-specific-services-or-principals-to-access-it
Check: CKV_AWS_116: "Ensure that AWS Lambda function is configured for a Dead Letter Queue(DLQ)"
	PASSED for resource: aws_lambda_function.store_event_to_s3
	File: /main.tf:75-102
	Guide: https://docs.bridgecrew.io/docs/ensure-that-aws-lambda-function-is-configured-for-a-dead-letter-queue-dlq
Check: CKV_AWS_45: "Ensure no hard-coded secrets exist in lambda environment"
	PASSED for resource: aws_lambda_function.store_event_to_s3
	File: /main.tf:75-102
	Guide: https://docs.bridgecrew.io/docs/bc_aws_secrets_3
Check: CKV_AWS_50: "X-ray tracing is enabled for Lambda"
	PASSED for resource: aws_lambda_function.store_event_to_s3
	File: /main.tf:75-102
	Guide: https://docs.bridgecrew.io/docs/bc_aws_serverless_4
Check: CKV_AWS_168: "Ensure SQS queue policy is not public by only allowing specific services or principals to access it"
	PASSED for resource: aws_sqs_queue.store_event_to_db_dlq
	File: /main.tf:104-106
	Guide: https://docs.bridgecrew.io/docs/ensure-sqs-queue-policy-is-not-public-by-only-allowing-specific-services-or-principals-to-access-it
Check: CKV_AWS_116: "Ensure that AWS Lambda function is configured for a Dead Letter Queue(DLQ)"
	PASSED for resource: aws_lambda_function.store_event_to_db
	File: /main.tf:108-143
	Guide: https://docs.bridgecrew.io/docs/ensure-that-aws-lambda-function-is-configured-for-a-dead-letter-queue-dlq
Check: CKV_AWS_45: "Ensure no hard-coded secrets exist in lambda environment"
	PASSED for resource: aws_lambda_function.store_event_to_db
	File: /main.tf:108-143
	Guide: https://docs.bridgecrew.io/docs/bc_aws_secrets_3
Check: CKV_AWS_50: "X-ray tracing is enabled for Lambda"
	PASSED for resource: aws_lambda_function.store_event_to_db
	File: /main.tf:108-143
	Guide: https://docs.bridgecrew.io/docs/bc_aws_serverless_4
Check: CKV_AWS_93: "Ensure S3 bucket policy does not lockout all but root user. (Prevent lockouts needing root account fixes)"
	PASSED for resource: aws_s3_bucket.s3_bucket
	File: /main.tf:196-198
	Guide: https://docs.bridgecrew.io/docs/bc_aws_s3_24
Check: CKV_AWS_56: "Ensure S3 bucket has 'restrict_public_bucket' enabled"
	PASSED for resource: aws_s3_bucket_public_access_block.access_s3_bucket
	File: /main.tf:200-207
	Guide: https://docs.bridgecrew.io/docs/bc_aws_s3_22
Check: CKV_AWS_55: "Ensure S3 bucket has ignore public ACLs enabled"
	PASSED for resource: aws_s3_bucket_public_access_block.access_s3_bucket
	File: /main.tf:200-207
	Guide: https://docs.bridgecrew.io/docs/bc_aws_s3_21
Check: CKV_AWS_54: "Ensure S3 bucket has block public policy enabled"
	PASSED for resource: aws_s3_bucket_public_access_block.access_s3_bucket
	File: /main.tf:200-207
	Guide: https://docs.bridgecrew.io/docs/bc_aws_s3_20
Check: CKV_AWS_53: "Ensure S3 bucket has block public ACLS enabled"
	PASSED for resource: aws_s3_bucket_public_access_block.access_s3_bucket
	File: /main.tf:200-207
	Guide: https://docs.bridgecrew.io/docs/bc_aws_s3_19
Check: CKV_AWS_133: "Ensure that RDS instances has backup policy"
	PASSED for resource: aws_db_instance.pg_db
	File: /main.tf:236-248
	Guide: https://docs.bridgecrew.io/docs/ensure-that-rds-instances-have-backup-policy
Check: CKV_AWS_211: "Ensure RDS uses a modern CaCert"
	PASSED for resource: aws_db_instance.pg_db
	File: /main.tf:236-248
	Guide: https://docs.bridgecrew.io/docs/ensure-aws-rds-uses-a-modern-cacert
Check: CKV_AWS_130: "Ensure VPC subnets do not assign public IP by default"
	PASSED for resource: aws_subnet.subnet_1
	File: /main.tf:259-263
	Guide: https://docs.bridgecrew.io/docs/ensure-vpc-subnets-do-not-assign-public-ip-by-default
Check: CKV_AWS_130: "Ensure VPC subnets do not assign public IP by default"
	PASSED for resource: aws_subnet.subnet_2
	File: /main.tf:265-269
	Guide: https://docs.bridgecrew.io/docs/ensure-vpc-subnets-do-not-assign-public-ip-by-default
Check: CKV_AWS_61: "Ensure AWS IAM policy does not allow assume role permission across all services"
	PASSED for resource: aws_iam_role.lambda_role
	File: /main.tf:330-345
	Guide: https://docs.bridgecrew.io/docs/bc_aws_iam_45
Check: CKV_AWS_60: "Ensure IAM role allows only specific services or principals to assume it"
	PASSED for resource: aws_iam_role.lambda_role
	File: /main.tf:330-345
	Guide: https://docs.bridgecrew.io/docs/bc_aws_iam_44
Check: CKV_AWS_274: "Disallow IAM roles, users, and groups from using the AWS AdministratorAccess policy"
	PASSED for resource: aws_iam_role.lambda_role
	File: /main.tf:330-345
Check: CKV_AWS_274: "Disallow IAM roles, users, and groups from using the AWS AdministratorAccess policy"
	PASSED for resource: aws_iam_role_policy_attachment.lambda_role_policy_attachment
	File: /main.tf:347-350
Check: CKV_AWS_286: "Ensure IAM policies does not allow privilege escalation"
	PASSED for resource: aws_iam_policy.lambda_policy
	File: /main.tf:352-372
Check: CKV_AWS_62: "Ensure IAM policies that allow full "*-*" administrative privileges are not created"
	PASSED for resource: aws_iam_policy.lambda_policy
	File: /main.tf:352-372
	Guide: https://docs.bridgecrew.io/docs/iam_47
Check: CKV_AWS_63: "Ensure no IAM policies documents allow "*" as a statement's actions"
	PASSED for resource: aws_iam_policy.lambda_policy
	File: /main.tf:352-372
	Guide: https://docs.bridgecrew.io/docs/iam_48
Check: CKV_AWS_274: "Disallow IAM roles, users, and groups from using the AWS AdministratorAccess policy"
	PASSED for resource: aws_iam_role_policy_attachment.lambda_role_policy_attachment_2
	File: /main.tf:374-377
Check: CKV2_AWS_44: "Ensure AWS route table with VPC peering does not contain routes overly permissive to all traffic"
	PASSED for resource: aws_route_table.main_rtb
	File: /main.tf:302-309
	Guide: https://docs.bridgecrew.io/docs/ensure-aws-route-table-with-vpc-peering-does-not-contain-routes-overly-permissive-to-all-traffic
Check: CKV2_AWS_44: "Ensure AWS route table with VPC peering does not contain routes overly permissive to all traffic"
	PASSED for resource: aws_route.public_internet_gateway
	File: /main.tf:311-315
	Guide: https://docs.bridgecrew.io/docs/ensure-aws-route-table-with-vpc-peering-does-not-contain-routes-overly-permissive-to-all-traffic
Check: CKV_AWS_20: "S3 Bucket has an ACL defined which allows public READ access."
	PASSED for resource: aws_s3_bucket.s3_bucket
	File: /main.tf:196-198
	Guide: https://docs.bridgecrew.io/docs/s3_1-acl-read-permissions-everyone
Check: CKV2_AWS_35: "AWS NAT Gateways should be utilized for the default route"
	PASSED for resource: aws_route_table.main_rtb
	File: /main.tf:302-309
	Guide: https://docs.bridgecrew.io/docs/ensure-aws-nat-gateways-are-utilized-for-the-default-route
Check: CKV2_AWS_35: "AWS NAT Gateways should be utilized for the default route"
	PASSED for resource: aws_route.public_internet_gateway
	File: /main.tf:311-315
	Guide: https://docs.bridgecrew.io/docs/ensure-aws-nat-gateways-are-utilized-for-the-default-route
Check: CKV2_AWS_5: "Ensure that Security Groups are attached to another resource"
	PASSED for resource: aws_security_group.main_sg
	File: /main.tf:271-291
	Guide: https://docs.bridgecrew.io/docs/ensure-that-security-groups-are-attached-to-ec2-instances-or-elastic-network-interfaces-enis
Check: CKV2_AWS_56: "Ensure AWS Managed IAMFullAccess IAM policy is not used."
	PASSED for resource: aws_iam_role.lambda_role
	File: /main.tf:330-345
Check: CKV2_AWS_56: "Ensure AWS Managed IAMFullAccess IAM policy is not used."
	PASSED for resource: aws_iam_role_policy_attachment.lambda_role_policy_attachment
	File: /main.tf:347-350
Check: CKV_AWS_57: "S3 Bucket has an ACL defined which allows public WRITE access."
	PASSED for resource: aws_s3_bucket.s3_bucket
	File: /main.tf:196-198
	Guide: https://docs.bridgecrew.io/docs/s3_2-acl-write-permissions-everyone
Check: CKV2_AWS_6: "Ensure that S3 bucket has a Public Access block"
	PASSED for resource: aws_s3_bucket.s3_bucket
	File: /main.tf:196-198
	Guide: https://docs.bridgecrew.io/docs/s3-bucket-should-have-public-access-blocks-defaults-to-false-if-the-public-access-block-is-not-attached
Check: CKV2_AWS_40: "Ensure AWS IAM policy does not allow full IAM privileges"
	PASSED for resource: aws_iam_policy.lambda_policy
	File: /main.tf:352-372
Check: CKV_AWS_19: "Ensure all data stored in the S3 bucket is securely encrypted at rest"
	PASSED for resource: aws_s3_bucket.s3_bucket
	File: /main.tf:196-198
	Guide: https://docs.bridgecrew.io/docs/s3_14-data-encrypted-at-rest
Check: CKV_AWS_27: "Ensure all data stored in the SQS queue is encrypted"
	FAILED for resource: aws_sqs_queue.ingest_event_dlq
	File: /main.tf:38-40
	Guide: https://docs.bridgecrew.io/docs/general_16-encrypt-sqs-queue

		38 | resource "aws_sqs_queue" "ingest_event_dlq" {
		39 |   name = "ingest_event_dlq"
		40 | }

Check: CKV_AWS_272: "Ensure AWS Lambda function is configured to validate code-signing"
	FAILED for resource: aws_lambda_function.ingest_event
	File: /main.tf:42-64

		42 | resource "aws_lambda_function" "ingest_event" {
		43 |   filename         = "aws_lambda_functions/ingest_event.zip"
		44 |   function_name    = "ingest_event"
		45 |   source_code_hash = data.archive_file.ingest_event.output_base64sha256
		46 |   handler          = "ingest_event.lambda_handler"
		47 |   runtime          = "python3.9"
		48 |   timeout          = 5
		49 |   role             = aws_iam_role.lambda_role.arn
		50 | 
		51 |   dead_letter_config {
		52 |     target_arn = aws_sqs_queue.ingest_event_dlq.arn
		53 |   }
		54 | 
		55 |   tracing_config {
		56 |     mode = "Active"
		57 |   }
		58 | 
		59 |   environment {
		60 |     variables = {
		61 |       KINESIS_STREAM = var.kinesis_stream
		62 |     }
		63 |   }
		64 | }

Check: CKV_AWS_173: "Check encryption settings for Lambda environmental variable"
	FAILED for resource: aws_lambda_function.ingest_event
	File: /main.tf:42-64
	Guide: https://docs.bridgecrew.io/docs/bc_aws_serverless_5

		42 | resource "aws_lambda_function" "ingest_event" {
		43 |   filename         = "aws_lambda_functions/ingest_event.zip"
		44 |   function_name    = "ingest_event"
		45 |   source_code_hash = data.archive_file.ingest_event.output_base64sha256
		46 |   handler          = "ingest_event.lambda_handler"
		47 |   runtime          = "python3.9"
		48 |   timeout          = 5
		49 |   role             = aws_iam_role.lambda_role.arn
		50 | 
		51 |   dead_letter_config {
		52 |     target_arn = aws_sqs_queue.ingest_event_dlq.arn
		53 |   }
		54 | 
		55 |   tracing_config {
		56 |     mode = "Active"
		57 |   }
		58 | 
		59 |   environment {
		60 |     variables = {
		61 |       KINESIS_STREAM = var.kinesis_stream
		62 |     }
		63 |   }
		64 | }

Check: CKV_AWS_117: "Ensure that AWS Lambda function is configured inside a VPC"
	FAILED for resource: aws_lambda_function.ingest_event
	File: /main.tf:42-64
	Guide: https://docs.bridgecrew.io/docs/ensure-that-aws-lambda-function-is-configured-inside-a-vpc-1

		42 | resource "aws_lambda_function" "ingest_event" {
		43 |   filename         = "aws_lambda_functions/ingest_event.zip"
		44 |   function_name    = "ingest_event"
		45 |   source_code_hash = data.archive_file.ingest_event.output_base64sha256
		46 |   handler          = "ingest_event.lambda_handler"
		47 |   runtime          = "python3.9"
		48 |   timeout          = 5
		49 |   role             = aws_iam_role.lambda_role.arn
		50 | 
		51 |   dead_letter_config {
		52 |     target_arn = aws_sqs_queue.ingest_event_dlq.arn
		53 |   }
		54 | 
		55 |   tracing_config {
		56 |     mode = "Active"
		57 |   }
		58 | 
		59 |   environment {
		60 |     variables = {
		61 |       KINESIS_STREAM = var.kinesis_stream
		62 |     }
		63 |   }
		64 | }

Check: CKV_AWS_115: "Ensure that AWS Lambda function is configured for function-level concurrent execution limit"
	FAILED for resource: aws_lambda_function.ingest_event
	File: /main.tf:42-64
	Guide: https://docs.bridgecrew.io/docs/ensure-that-aws-lambda-function-is-configured-for-function-level-concurrent-execution-limit

		42 | resource "aws_lambda_function" "ingest_event" {
		43 |   filename         = "aws_lambda_functions/ingest_event.zip"
		44 |   function_name    = "ingest_event"
		45 |   source_code_hash = data.archive_file.ingest_event.output_base64sha256
		46 |   handler          = "ingest_event.lambda_handler"
		47 |   runtime          = "python3.9"
		48 |   timeout          = 5
		49 |   role             = aws_iam_role.lambda_role.arn
		50 | 
		51 |   dead_letter_config {
		52 |     target_arn = aws_sqs_queue.ingest_event_dlq.arn
		53 |   }
		54 | 
		55 |   tracing_config {
		56 |     mode = "Active"
		57 |   }
		58 | 
		59 |   environment {
		60 |     variables = {
		61 |       KINESIS_STREAM = var.kinesis_stream
		62 |     }
		63 |   }
		64 | }

Check: CKV_AWS_27: "Ensure all data stored in the SQS queue is encrypted"
	FAILED for resource: aws_sqs_queue.store_event_to_s3_dlq
	File: /main.tf:71-73
	Guide: https://docs.bridgecrew.io/docs/general_16-encrypt-sqs-queue

		71 | resource "aws_sqs_queue" "store_event_to_s3_dlq" {
		72 |   name = "store_event_to_s3_dlq"
		73 | }

Check: CKV_AWS_272: "Ensure AWS Lambda function is configured to validate code-signing"
	FAILED for resource: aws_lambda_function.store_event_to_s3
	File: /main.tf:75-102

		75  | resource "aws_lambda_function" "store_event_to_s3" {
		76  |   filename         = "aws_lambda_functions/store_event_to_s3.zip"
		77  |   function_name    = "store_event_to_s3"
		78  |   source_code_hash = data.archive_file.store_event_to_s3.output_base64sha256
		79  |   handler          = "store_event_to_s3.lambda_handler"
		80  |   runtime          = "python3.9"
		81  |   timeout          = 20
		82  |   role             = aws_iam_role.lambda_role.arn
		83  | 
		84  |   dead_letter_config {
		85  |     target_arn = aws_sqs_queue.store_event_to_s3_dlq.arn
		86  |   }
		87  | 
		88  |   tracing_config {
		89  |     mode = "Active"
		90  |   }
		91  | 
		92  |   environment {
		93  |     variables = {
		94  |       S3_BUCKET = aws_s3_bucket.s3_bucket.id
		95  |     }
		96  |   }
		97  | 
		98  |   depends_on = [
		99  |     aws_kinesis_stream.kinesis_stream,
		100 |     aws_s3_bucket.s3_bucket
		101 |   ]
		102 | }

Check: CKV_AWS_173: "Check encryption settings for Lambda environmental variable"
	FAILED for resource: aws_lambda_function.store_event_to_s3
	File: /main.tf:75-102
	Guide: https://docs.bridgecrew.io/docs/bc_aws_serverless_5

		75  | resource "aws_lambda_function" "store_event_to_s3" {
		76  |   filename         = "aws_lambda_functions/store_event_to_s3.zip"
		77  |   function_name    = "store_event_to_s3"
		78  |   source_code_hash = data.archive_file.store_event_to_s3.output_base64sha256
		79  |   handler          = "store_event_to_s3.lambda_handler"
		80  |   runtime          = "python3.9"
		81  |   timeout          = 20
		82  |   role             = aws_iam_role.lambda_role.arn
		83  | 
		84  |   dead_letter_config {
		85  |     target_arn = aws_sqs_queue.store_event_to_s3_dlq.arn
		86  |   }
		87  | 
		88  |   tracing_config {
		89  |     mode = "Active"
		90  |   }
		91  | 
		92  |   environment {
		93  |     variables = {
		94  |       S3_BUCKET = aws_s3_bucket.s3_bucket.id
		95  |     }
		96  |   }
		97  | 
		98  |   depends_on = [
		99  |     aws_kinesis_stream.kinesis_stream,
		100 |     aws_s3_bucket.s3_bucket
		101 |   ]
		102 | }

Check: CKV_AWS_117: "Ensure that AWS Lambda function is configured inside a VPC"
	FAILED for resource: aws_lambda_function.store_event_to_s3
	File: /main.tf:75-102
	Guide: https://docs.bridgecrew.io/docs/ensure-that-aws-lambda-function-is-configured-inside-a-vpc-1

		75  | resource "aws_lambda_function" "store_event_to_s3" {
		76  |   filename         = "aws_lambda_functions/store_event_to_s3.zip"
		77  |   function_name    = "store_event_to_s3"
		78  |   source_code_hash = data.archive_file.store_event_to_s3.output_base64sha256
		79  |   handler          = "store_event_to_s3.lambda_handler"
		80  |   runtime          = "python3.9"
		81  |   timeout          = 20
		82  |   role             = aws_iam_role.lambda_role.arn
		83  | 
		84  |   dead_letter_config {
		85  |     target_arn = aws_sqs_queue.store_event_to_s3_dlq.arn
		86  |   }
		87  | 
		88  |   tracing_config {
		89  |     mode = "Active"
		90  |   }
		91  | 
		92  |   environment {
		93  |     variables = {
		94  |       S3_BUCKET = aws_s3_bucket.s3_bucket.id
		95  |     }
		96  |   }
		97  | 
		98  |   depends_on = [
		99  |     aws_kinesis_stream.kinesis_stream,
		100 |     aws_s3_bucket.s3_bucket
		101 |   ]
		102 | }

Check: CKV_AWS_115: "Ensure that AWS Lambda function is configured for function-level concurrent execution limit"
	FAILED for resource: aws_lambda_function.store_event_to_s3
	File: /main.tf:75-102
	Guide: https://docs.bridgecrew.io/docs/ensure-that-aws-lambda-function-is-configured-for-function-level-concurrent-execution-limit

		75  | resource "aws_lambda_function" "store_event_to_s3" {
		76  |   filename         = "aws_lambda_functions/store_event_to_s3.zip"
		77  |   function_name    = "store_event_to_s3"
		78  |   source_code_hash = data.archive_file.store_event_to_s3.output_base64sha256
		79  |   handler          = "store_event_to_s3.lambda_handler"
		80  |   runtime          = "python3.9"
		81  |   timeout          = 20
		82  |   role             = aws_iam_role.lambda_role.arn
		83  | 
		84  |   dead_letter_config {
		85  |     target_arn = aws_sqs_queue.store_event_to_s3_dlq.arn
		86  |   }
		87  | 
		88  |   tracing_config {
		89  |     mode = "Active"
		90  |   }
		91  | 
		92  |   environment {
		93  |     variables = {
		94  |       S3_BUCKET = aws_s3_bucket.s3_bucket.id
		95  |     }
		96  |   }
		97  | 
		98  |   depends_on = [
		99  |     aws_kinesis_stream.kinesis_stream,
		100 |     aws_s3_bucket.s3_bucket
		101 |   ]
		102 | }

Check: CKV_AWS_27: "Ensure all data stored in the SQS queue is encrypted"
	FAILED for resource: aws_sqs_queue.store_event_to_db_dlq
	File: /main.tf:104-106
	Guide: https://docs.bridgecrew.io/docs/general_16-encrypt-sqs-queue

		104 | resource "aws_sqs_queue" "store_event_to_db_dlq" {
		105 |   name = "store_event_to_db_dlq"
		106 | }

Check: CKV_AWS_272: "Ensure AWS Lambda function is configured to validate code-signing"
	FAILED for resource: aws_lambda_function.store_event_to_db
	File: /main.tf:108-143

		108 | resource "aws_lambda_function" "store_event_to_db" {
		109 |   filename         = "aws_lambda_functions/store_event_to_db.zip"
		110 |   function_name    = "store_event_to_db"
		111 |   source_code_hash = data.archive_file.store_event_to_db.output_base64sha256
		112 |   handler          = "store_event_to_db.lambda_handler"
		113 |   runtime          = "python3.9"
		114 |   timeout          = 20
		115 |   role             = aws_iam_role.lambda_role.arn
		116 | 
		117 |   dead_letter_config {
		118 |     target_arn = aws_sqs_queue.store_event_to_db_dlq.arn
		119 |   }
		120 | 
		121 |   tracing_config {
		122 |     mode = "Active"
		123 |   }
		124 | 
		125 |   layers = [
		126 |     aws_lambda_layer_version.lambda_psycopg2_layer.arn
		127 |   ]
		128 | 
		129 |   environment {
		130 |     variables = {
		131 |       #SECRET_NAME = aws_secretsmanager_secret.rds_secret.name
		132 |       USERNAME = aws_db_instance.pg_db.username
		133 |       PASSWORD = aws_db_instance.pg_db.password
		134 |       ENDPOINT = aws_db_instance.pg_db.endpoint
		135 |       DB       = aws_db_instance.pg_db.db_name
		136 |     }
		137 |   }
		138 | 
		139 |   depends_on = [
		140 |     aws_lambda_layer_version.lambda_psycopg2_layer,
		141 |     aws_db_instance.pg_db
		142 |   ]
		143 | }

Check: CKV_AWS_173: "Check encryption settings for Lambda environmental variable"
	FAILED for resource: aws_lambda_function.store_event_to_db
	File: /main.tf:108-143
	Guide: https://docs.bridgecrew.io/docs/bc_aws_serverless_5

		108 | resource "aws_lambda_function" "store_event_to_db" {
		109 |   filename         = "aws_lambda_functions/store_event_to_db.zip"
		110 |   function_name    = "store_event_to_db"
		111 |   source_code_hash = data.archive_file.store_event_to_db.output_base64sha256
		112 |   handler          = "store_event_to_db.lambda_handler"
		113 |   runtime          = "python3.9"
		114 |   timeout          = 20
		115 |   role             = aws_iam_role.lambda_role.arn
		116 | 
		117 |   dead_letter_config {
		118 |     target_arn = aws_sqs_queue.store_event_to_db_dlq.arn
		119 |   }
		120 | 
		121 |   tracing_config {
		122 |     mode = "Active"
		123 |   }
		124 | 
		125 |   layers = [
		126 |     aws_lambda_layer_version.lambda_psycopg2_layer.arn
		127 |   ]
		128 | 
		129 |   environment {
		130 |     variables = {
		131 |       #SECRET_NAME = aws_secretsmanager_secret.rds_secret.name
		132 |       USERNAME = aws_db_instance.pg_db.username
		133 |       PASSWORD = aws_db_instance.pg_db.password
		134 |       ENDPOINT = aws_db_instance.pg_db.endpoint
		135 |       DB       = aws_db_instance.pg_db.db_name
		136 |     }
		137 |   }
		138 | 
		139 |   depends_on = [
		140 |     aws_lambda_layer_version.lambda_psycopg2_layer,
		141 |     aws_db_instance.pg_db
		142 |   ]
		143 | }

Check: CKV_AWS_117: "Ensure that AWS Lambda function is configured inside a VPC"
	FAILED for resource: aws_lambda_function.store_event_to_db
	File: /main.tf:108-143
	Guide: https://docs.bridgecrew.io/docs/ensure-that-aws-lambda-function-is-configured-inside-a-vpc-1

		108 | resource "aws_lambda_function" "store_event_to_db" {
		109 |   filename         = "aws_lambda_functions/store_event_to_db.zip"
		110 |   function_name    = "store_event_to_db"
		111 |   source_code_hash = data.archive_file.store_event_to_db.output_base64sha256
		112 |   handler          = "store_event_to_db.lambda_handler"
		113 |   runtime          = "python3.9"
		114 |   timeout          = 20
		115 |   role             = aws_iam_role.lambda_role.arn
		116 | 
		117 |   dead_letter_config {
		118 |     target_arn = aws_sqs_queue.store_event_to_db_dlq.arn
		119 |   }
		120 | 
		121 |   tracing_config {
		122 |     mode = "Active"
		123 |   }
		124 | 
		125 |   layers = [
		126 |     aws_lambda_layer_version.lambda_psycopg2_layer.arn
		127 |   ]
		128 | 
		129 |   environment {
		130 |     variables = {
		131 |       #SECRET_NAME = aws_secretsmanager_secret.rds_secret.name
		132 |       USERNAME = aws_db_instance.pg_db.username
		133 |       PASSWORD = aws_db_instance.pg_db.password
		134 |       ENDPOINT = aws_db_instance.pg_db.endpoint
		135 |       DB       = aws_db_instance.pg_db.db_name
		136 |     }
		137 |   }
		138 | 
		139 |   depends_on = [
		140 |     aws_lambda_layer_version.lambda_psycopg2_layer,
		141 |     aws_db_instance.pg_db
		142 |   ]
		143 | }

Check: CKV_AWS_115: "Ensure that AWS Lambda function is configured for function-level concurrent execution limit"
	FAILED for resource: aws_lambda_function.store_event_to_db
	File: /main.tf:108-143
	Guide: https://docs.bridgecrew.io/docs/ensure-that-aws-lambda-function-is-configured-for-function-level-concurrent-execution-limit

		108 | resource "aws_lambda_function" "store_event_to_db" {
		109 |   filename         = "aws_lambda_functions/store_event_to_db.zip"
		110 |   function_name    = "store_event_to_db"
		111 |   source_code_hash = data.archive_file.store_event_to_db.output_base64sha256
		112 |   handler          = "store_event_to_db.lambda_handler"
		113 |   runtime          = "python3.9"
		114 |   timeout          = 20
		115 |   role             = aws_iam_role.lambda_role.arn
		116 | 
		117 |   dead_letter_config {
		118 |     target_arn = aws_sqs_queue.store_event_to_db_dlq.arn
		119 |   }
		120 | 
		121 |   tracing_config {
		122 |     mode = "Active"
		123 |   }
		124 | 
		125 |   layers = [
		126 |     aws_lambda_layer_version.lambda_psycopg2_layer.arn
		127 |   ]
		128 | 
		129 |   environment {
		130 |     variables = {
		131 |       #SECRET_NAME = aws_secretsmanager_secret.rds_secret.name
		132 |       USERNAME = aws_db_instance.pg_db.username
		133 |       PASSWORD = aws_db_instance.pg_db.password
		134 |       ENDPOINT = aws_db_instance.pg_db.endpoint
		135 |       DB       = aws_db_instance.pg_db.db_name
		136 |     }
		137 |   }
		138 | 
		139 |   depends_on = [
		140 |     aws_lambda_layer_version.lambda_psycopg2_layer,
		141 |     aws_db_instance.pg_db
		142 |   ]
		143 | }

Check: CKV_AWS_43: "Ensure Kinesis Stream is securely encrypted"
	FAILED for resource: aws_kinesis_stream.kinesis_stream
	File: /main.tf:159-167
	Guide: https://docs.bridgecrew.io/docs/bc_aws_general_22

		159 | resource "aws_kinesis_stream" "kinesis_stream" {
		160 |   name             = var.kinesis_stream
		161 |   shard_count      = 1
		162 |   retention_period = 24
		163 |   
		164 |   stream_mode_details {
		165 |     stream_mode = "PROVISIONED"
		166 |   }
		167 | }

Check: CKV_AWS_185: "Ensure Kinesis Stream is encrypted by KMS using a customer managed Key (CMK)"
	FAILED for resource: aws_kinesis_stream.kinesis_stream
	File: /main.tf:159-167
	Guide: https://docs.bridgecrew.io/docs/bc_aws_general_105

		159 | resource "aws_kinesis_stream" "kinesis_stream" {
		160 |   name             = var.kinesis_stream
		161 |   shard_count      = 1
		162 |   retention_period = 24
		163 |   
		164 |   stream_mode_details {
		165 |     stream_mode = "PROVISIONED"
		166 |   }
		167 | }

Check: CKV_AWS_149: "Ensure that Secrets Manager secret is encrypted using KMS CMK"
	FAILED for resource: aws_secretsmanager_secret.rds_secret
	File: /main.tf:217-219
	Guide: https://docs.bridgecrew.io/docs/ensure-that-secrets-manager-secret-is-encrypted-using-kms

		217 | resource "aws_secretsmanager_secret" "rds_secret" {
		218 |   name_prefix = "pg_rds_secret"
		219 | }

Check: CKV_AWS_161: "Ensure RDS database has IAM authentication enabled"
	FAILED for resource: aws_db_instance.pg_db
	File: /main.tf:236-248
	Guide: https://docs.bridgecrew.io/docs/ensure-rds-database-has-iam-authentication-enabled

		236 | resource "aws_db_instance" "pg_db" {
		237 |   allocated_storage    = 10
		238 |   apply_immediately    = true
		239 |   db_name              = "hw_db"
		240 |   engine               = "postgres"
		241 |   instance_class       = "db.t3.micro"
		242 |   username             = "lambda"
		243 |   password             = random_password.db_password.result
		244 |   skip_final_snapshot  = true
		245 |   publicly_accessible  = true
		246 |   db_subnet_group_name = aws_db_subnet_group.db_subnet_group.id
		247 |   vpc_security_group_ids = [aws_security_group.main_sg.id]
		248 | }

Check: CKV_AWS_16: "Ensure all data stored in the RDS is securely encrypted at rest"
	FAILED for resource: aws_db_instance.pg_db
	File: /main.tf:236-248
	Guide: https://docs.bridgecrew.io/docs/general_4

		236 | resource "aws_db_instance" "pg_db" {
		237 |   allocated_storage    = 10
		238 |   apply_immediately    = true
		239 |   db_name              = "hw_db"
		240 |   engine               = "postgres"
		241 |   instance_class       = "db.t3.micro"
		242 |   username             = "lambda"
		243 |   password             = random_password.db_password.result
		244 |   skip_final_snapshot  = true
		245 |   publicly_accessible  = true
		246 |   db_subnet_group_name = aws_db_subnet_group.db_subnet_group.id
		247 |   vpc_security_group_ids = [aws_security_group.main_sg.id]
		248 | }

Check: CKV_AWS_293: "Ensure that AWS database instances have deletion protection enabled"
	FAILED for resource: aws_db_instance.pg_db
	File: /main.tf:236-248

		236 | resource "aws_db_instance" "pg_db" {
		237 |   allocated_storage    = 10
		238 |   apply_immediately    = true
		239 |   db_name              = "hw_db"
		240 |   engine               = "postgres"
		241 |   instance_class       = "db.t3.micro"
		242 |   username             = "lambda"
		243 |   password             = random_password.db_password.result
		244 |   skip_final_snapshot  = true
		245 |   publicly_accessible  = true
		246 |   db_subnet_group_name = aws_db_subnet_group.db_subnet_group.id
		247 |   vpc_security_group_ids = [aws_security_group.main_sg.id]
		248 | }

Check: CKV_AWS_129: "Ensure that respective logs of Amazon Relational Database Service (Amazon RDS) are enabled"
	FAILED for resource: aws_db_instance.pg_db
	File: /main.tf:236-248
	Guide: https://docs.bridgecrew.io/docs/ensure-that-respective-logs-of-amazon-relational-database-service-amazon-rds-are-enabled

		236 | resource "aws_db_instance" "pg_db" {
		237 |   allocated_storage    = 10
		238 |   apply_immediately    = true
		239 |   db_name              = "hw_db"
		240 |   engine               = "postgres"
		241 |   instance_class       = "db.t3.micro"
		242 |   username             = "lambda"
		243 |   password             = random_password.db_password.result
		244 |   skip_final_snapshot  = true
		245 |   publicly_accessible  = true
		246 |   db_subnet_group_name = aws_db_subnet_group.db_subnet_group.id
		247 |   vpc_security_group_ids = [aws_security_group.main_sg.id]
		248 | }

Check: CKV_AWS_157: "Ensure that RDS instances have Multi-AZ enabled"
	FAILED for resource: aws_db_instance.pg_db
	File: /main.tf:236-248
	Guide: https://docs.bridgecrew.io/docs/general_73

		236 | resource "aws_db_instance" "pg_db" {
		237 |   allocated_storage    = 10
		238 |   apply_immediately    = true
		239 |   db_name              = "hw_db"
		240 |   engine               = "postgres"
		241 |   instance_class       = "db.t3.micro"
		242 |   username             = "lambda"
		243 |   password             = random_password.db_password.result
		244 |   skip_final_snapshot  = true
		245 |   publicly_accessible  = true
		246 |   db_subnet_group_name = aws_db_subnet_group.db_subnet_group.id
		247 |   vpc_security_group_ids = [aws_security_group.main_sg.id]
		248 | }

Check: CKV_AWS_17: "Ensure all data stored in RDS is not publicly accessible"
	FAILED for resource: aws_db_instance.pg_db
	File: /main.tf:236-248
	Guide: https://docs.bridgecrew.io/docs/public_2

		236 | resource "aws_db_instance" "pg_db" {
		237 |   allocated_storage    = 10
		238 |   apply_immediately    = true
		239 |   db_name              = "hw_db"
		240 |   engine               = "postgres"
		241 |   instance_class       = "db.t3.micro"
		242 |   username             = "lambda"
		243 |   password             = random_password.db_password.result
		244 |   skip_final_snapshot  = true
		245 |   publicly_accessible  = true
		246 |   db_subnet_group_name = aws_db_subnet_group.db_subnet_group.id
		247 |   vpc_security_group_ids = [aws_security_group.main_sg.id]
		248 | }

Check: CKV_AWS_226: "Ensure DB instance gets all minor upgrades automatically"
	FAILED for resource: aws_db_instance.pg_db
	File: /main.tf:236-248
	Guide: https://docs.bridgecrew.io/docs/ensure-aws-db-instance-gets-all-minor-upgrades-automatically

		236 | resource "aws_db_instance" "pg_db" {
		237 |   allocated_storage    = 10
		238 |   apply_immediately    = true
		239 |   db_name              = "hw_db"
		240 |   engine               = "postgres"
		241 |   instance_class       = "db.t3.micro"
		242 |   username             = "lambda"
		243 |   password             = random_password.db_password.result
		244 |   skip_final_snapshot  = true
		245 |   publicly_accessible  = true
		246 |   db_subnet_group_name = aws_db_subnet_group.db_subnet_group.id
		247 |   vpc_security_group_ids = [aws_security_group.main_sg.id]
		248 | }

Check: CKV_AWS_118: "Ensure that enhanced monitoring is enabled for Amazon RDS instances"
	FAILED for resource: aws_db_instance.pg_db
	File: /main.tf:236-248
	Guide: https://docs.bridgecrew.io/docs/ensure-that-enhanced-monitoring-is-enabled-for-amazon-rds-instances

		236 | resource "aws_db_instance" "pg_db" {
		237 |   allocated_storage    = 10
		238 |   apply_immediately    = true
		239 |   db_name              = "hw_db"
		240 |   engine               = "postgres"
		241 |   instance_class       = "db.t3.micro"
		242 |   username             = "lambda"
		243 |   password             = random_password.db_password.result
		244 |   skip_final_snapshot  = true
		245 |   publicly_accessible  = true
		246 |   db_subnet_group_name = aws_db_subnet_group.db_subnet_group.id
		247 |   vpc_security_group_ids = [aws_security_group.main_sg.id]
		248 | }

Check: CKV_AWS_277: "Ensure no security groups allow ingress from 0.0.0.0:0 to port -1"
	FAILED for resource: aws_security_group.main_sg
	File: /main.tf:271-291
	Guide: https://docs.bridgecrew.io/docs/ensure-aws-security-group-does-not-allow-all-traffic-on-all-ports

		271 | resource "aws_security_group" "main_sg" {
		272 |   name   = "main_sg"
		273 |   description = "Security group for AWS lambda and AWS RDS connection"
		274 |   vpc_id = aws_vpc.main.id
		275 | 
		276 |   # Only postgres in
		277 |   ingress {
		278 |     from_port = 0
		279 |     to_port = 0
		280 |     protocol = "-1"
		281 |     cidr_blocks = ["0.0.0.0/0"]
		282 |   }
		283 | 
		284 |   # Allow all outbound traffic.
		285 |   egress {
		286 |     from_port = 0
		287 |     to_port = 0
		288 |     protocol = "-1"
		289 |     cidr_blocks = ["0.0.0.0/0"]
		290 |   }
		291 | }

Check: CKV_AWS_23: "Ensure every security groups rule has a description"
	FAILED for resource: aws_security_group.main_sg
	File: /main.tf:271-291
	Guide: https://docs.bridgecrew.io/docs/networking_31

		271 | resource "aws_security_group" "main_sg" {
		272 |   name   = "main_sg"
		273 |   description = "Security group for AWS lambda and AWS RDS connection"
		274 |   vpc_id = aws_vpc.main.id
		275 | 
		276 |   # Only postgres in
		277 |   ingress {
		278 |     from_port = 0
		279 |     to_port = 0
		280 |     protocol = "-1"
		281 |     cidr_blocks = ["0.0.0.0/0"]
		282 |   }
		283 | 
		284 |   # Allow all outbound traffic.
		285 |   egress {
		286 |     from_port = 0
		287 |     to_port = 0
		288 |     protocol = "-1"
		289 |     cidr_blocks = ["0.0.0.0/0"]
		290 |   }
		291 | }

Check: CKV_AWS_24: "Ensure no security groups allow ingress from 0.0.0.0:0 to port 22"
	FAILED for resource: aws_security_group.main_sg
	File: /main.tf:271-291
	Guide: https://docs.bridgecrew.io/docs/networking_1-port-security

		271 | resource "aws_security_group" "main_sg" {
		272 |   name   = "main_sg"
		273 |   description = "Security group for AWS lambda and AWS RDS connection"
		274 |   vpc_id = aws_vpc.main.id
		275 | 
		276 |   # Only postgres in
		277 |   ingress {
		278 |     from_port = 0
		279 |     to_port = 0
		280 |     protocol = "-1"
		281 |     cidr_blocks = ["0.0.0.0/0"]
		282 |   }
		283 | 
		284 |   # Allow all outbound traffic.
		285 |   egress {
		286 |     from_port = 0
		287 |     to_port = 0
		288 |     protocol = "-1"
		289 |     cidr_blocks = ["0.0.0.0/0"]
		290 |   }
		291 | }

Check: CKV_AWS_260: "Ensure no security groups allow ingress from 0.0.0.0:0 to port 80"
	FAILED for resource: aws_security_group.main_sg
	File: /main.tf:271-291
	Guide: https://docs.bridgecrew.io/docs/ensure-aws-security-groups-do-not-allow-ingress-from-00000-to-port-80

		271 | resource "aws_security_group" "main_sg" {
		272 |   name   = "main_sg"
		273 |   description = "Security group for AWS lambda and AWS RDS connection"
		274 |   vpc_id = aws_vpc.main.id
		275 | 
		276 |   # Only postgres in
		277 |   ingress {
		278 |     from_port = 0
		279 |     to_port = 0
		280 |     protocol = "-1"
		281 |     cidr_blocks = ["0.0.0.0/0"]
		282 |   }
		283 | 
		284 |   # Allow all outbound traffic.
		285 |   egress {
		286 |     from_port = 0
		287 |     to_port = 0
		288 |     protocol = "-1"
		289 |     cidr_blocks = ["0.0.0.0/0"]
		290 |   }
		291 | }

Check: CKV_AWS_25: "Ensure no security groups allow ingress from 0.0.0.0:0 to port 3389"
	FAILED for resource: aws_security_group.main_sg
	File: /main.tf:271-291
	Guide: https://docs.bridgecrew.io/docs/networking_2

		271 | resource "aws_security_group" "main_sg" {
		272 |   name   = "main_sg"
		273 |   description = "Security group for AWS lambda and AWS RDS connection"
		274 |   vpc_id = aws_vpc.main.id
		275 | 
		276 |   # Only postgres in
		277 |   ingress {
		278 |     from_port = 0
		279 |     to_port = 0
		280 |     protocol = "-1"
		281 |     cidr_blocks = ["0.0.0.0/0"]
		282 |   }
		283 | 
		284 |   # Allow all outbound traffic.
		285 |   egress {
		286 |     from_port = 0
		287 |     to_port = 0
		288 |     protocol = "-1"
		289 |     cidr_blocks = ["0.0.0.0/0"]
		290 |   }
		291 | }

Check: CKV_AWS_288: "Ensure IAM policies does not allow data exfiltration"
	FAILED for resource: aws_iam_policy.lambda_policy
	File: /main.tf:352-372

		352 | resource "aws_iam_policy" "lambda_policy" {
		353 |   name = "lambda_policy"
		354 | 
		355 |   policy = jsonencode({
		356 |     Version = "2012-10-17"
		357 |     Statement = [
		358 |       {
		359 |         Effect = "Allow"
		360 |         Action = [
		361 |           "logs:*",
		362 |           "cloudwatch:*",
		363 |           "kinesis:*",
		364 |           "s3:*",
		365 |           "ec2:*",
		366 |           "secretsmanager:*"
		367 |         ]
		368 |         Resource = "*"
		369 |       }
		370 |     ]
		371 |   })
		372 | }

Check: CKV_AWS_289: "Ensure IAM policies does not allow permissions management / resource exposure without constraints"
	FAILED for resource: aws_iam_policy.lambda_policy
	File: /main.tf:352-372

		352 | resource "aws_iam_policy" "lambda_policy" {
		353 |   name = "lambda_policy"
		354 | 
		355 |   policy = jsonencode({
		356 |     Version = "2012-10-17"
		357 |     Statement = [
		358 |       {
		359 |         Effect = "Allow"
		360 |         Action = [
		361 |           "logs:*",
		362 |           "cloudwatch:*",
		363 |           "kinesis:*",
		364 |           "s3:*",
		365 |           "ec2:*",
		366 |           "secretsmanager:*"
		367 |         ]
		368 |         Resource = "*"
		369 |       }
		370 |     ]
		371 |   })
		372 | }

Check: CKV_AWS_287: "Ensure IAM policies does not allow credentials exposure"
	FAILED for resource: aws_iam_policy.lambda_policy
	File: /main.tf:352-372

		352 | resource "aws_iam_policy" "lambda_policy" {
		353 |   name = "lambda_policy"
		354 | 
		355 |   policy = jsonencode({
		356 |     Version = "2012-10-17"
		357 |     Statement = [
		358 |       {
		359 |         Effect = "Allow"
		360 |         Action = [
		361 |           "logs:*",
		362 |           "cloudwatch:*",
		363 |           "kinesis:*",
		364 |           "s3:*",
		365 |           "ec2:*",
		366 |           "secretsmanager:*"
		367 |         ]
		368 |         Resource = "*"
		369 |       }
		370 |     ]
		371 |   })
		372 | }

Check: CKV_AWS_290: "Ensure IAM policies does not allow write access without constraints"
	FAILED for resource: aws_iam_policy.lambda_policy
	File: /main.tf:352-372

		352 | resource "aws_iam_policy" "lambda_policy" {
		353 |   name = "lambda_policy"
		354 | 
		355 |   policy = jsonencode({
		356 |     Version = "2012-10-17"
		357 |     Statement = [
		358 |       {
		359 |         Effect = "Allow"
		360 |         Action = [
		361 |           "logs:*",
		362 |           "cloudwatch:*",
		363 |           "kinesis:*",
		364 |           "s3:*",
		365 |           "ec2:*",
		366 |           "secretsmanager:*"
		367 |         ]
		368 |         Resource = "*"
		369 |       }
		370 |     ]
		371 |   })
		372 | }

Check: CKV2_AWS_11: "Ensure VPC flow logging is enabled in all VPCs"
	FAILED for resource: aws_vpc.main
	File: /main.tf:253-257
	Guide: https://docs.bridgecrew.io/docs/logging_9-enable-vpc-flow-logging

		253 | resource "aws_vpc" "main" {
		254 |   cidr_block = "10.0.0.0/16"
		255 |   enable_dns_hostnames = true
		256 |   enable_dns_support   = true
		257 | }

Check: CKV2_AWS_57: "Ensure Secrets Manager secrets should have automatic rotation enabled"
	FAILED for resource: aws_secretsmanager_secret.rds_secret
	File: /main.tf:217-219

		217 | resource "aws_secretsmanager_secret" "rds_secret" {
		218 |   name_prefix = "pg_rds_secret"
		219 | }

Check: CKV_AWS_18: "Ensure the S3 bucket has access logging enabled"
	FAILED for resource: aws_s3_bucket.s3_bucket
	File: /main.tf:196-198
	Guide: https://docs.bridgecrew.io/docs/s3_13-enable-logging

		196 | resource "aws_s3_bucket" "s3_bucket" {
		197 |   bucket_prefix = var.s3_bucket_prefix
		198 | }

Check: CKV2_AWS_61: "Ensure that an S3 bucket has a lifecycle configuration"
	FAILED for resource: aws_s3_bucket.s3_bucket
	File: /main.tf:196-198

		196 | resource "aws_s3_bucket" "s3_bucket" {
		197 |   bucket_prefix = var.s3_bucket_prefix
		198 | }

Check: CKV_AWS_145: "Ensure that S3 buckets are encrypted with KMS by default"
	FAILED for resource: aws_s3_bucket.s3_bucket
	File: /main.tf:196-198
	Guide: https://docs.bridgecrew.io/docs/ensure-that-s3-buckets-are-encrypted-with-kms-by-default

		196 | resource "aws_s3_bucket" "s3_bucket" {
		197 |   bucket_prefix = var.s3_bucket_prefix
		198 | }

Check: CKV2_AWS_60: "Ensure RDS instance with copy tags to snapshots is enabled"
	FAILED for resource: aws_db_instance.pg_db
	File: /main.tf:236-248

		236 | resource "aws_db_instance" "pg_db" {
		237 |   allocated_storage    = 10
		238 |   apply_immediately    = true
		239 |   db_name              = "hw_db"
		240 |   engine               = "postgres"
		241 |   instance_class       = "db.t3.micro"
		242 |   username             = "lambda"
		243 |   password             = random_password.db_password.result
		244 |   skip_final_snapshot  = true
		245 |   publicly_accessible  = true
		246 |   db_subnet_group_name = aws_db_subnet_group.db_subnet_group.id
		247 |   vpc_security_group_ids = [aws_security_group.main_sg.id]
		248 | }

Check: CKV2_AWS_30: "Ensure Postgres RDS as aws_db_instance has Query Logging enabled"
	FAILED for resource: aws_db_instance.pg_db
	File: /main.tf:236-248
	Guide: https://docs.bridgecrew.io/docs/bc_aws_logging_32

		236 | resource "aws_db_instance" "pg_db" {
		237 |   allocated_storage    = 10
		238 |   apply_immediately    = true
		239 |   db_name              = "hw_db"
		240 |   engine               = "postgres"
		241 |   instance_class       = "db.t3.micro"
		242 |   username             = "lambda"
		243 |   password             = random_password.db_password.result
		244 |   skip_final_snapshot  = true
		245 |   publicly_accessible  = true
		246 |   db_subnet_group_name = aws_db_subnet_group.db_subnet_group.id
		247 |   vpc_security_group_ids = [aws_security_group.main_sg.id]
		248 | }

Check: CKV_AWS_144: "Ensure that S3 bucket has cross-region replication enabled"
	FAILED for resource: aws_s3_bucket.s3_bucket
	File: /main.tf:196-198
	Guide: https://docs.bridgecrew.io/docs/ensure-that-s3-bucket-has-cross-region-replication-enabled

		196 | resource "aws_s3_bucket" "s3_bucket" {
		197 |   bucket_prefix = var.s3_bucket_prefix
		198 | }

Check: CKV2_AWS_62: "Ensure S3 buckets should have event notifications enabled"
	FAILED for resource: aws_s3_bucket.s3_bucket
	File: /main.tf:196-198

		196 | resource "aws_s3_bucket" "s3_bucket" {
		197 |   bucket_prefix = var.s3_bucket_prefix
		198 | }

Check: CKV2_AWS_12: "Ensure the default security group of every VPC restricts all traffic"
	FAILED for resource: aws_vpc.main
	File: /main.tf:253-257
	Guide: https://docs.bridgecrew.io/docs/networking_4

		253 | resource "aws_vpc" "main" {
		254 |   cidr_block = "10.0.0.0/16"
		255 |   enable_dns_hostnames = true
		256 |   enable_dns_support   = true
		257 | }

Check: CKV_AWS_21: "Ensure all data stored in the S3 bucket have versioning enabled"
	FAILED for resource: aws_s3_bucket.s3_bucket
	File: /main.tf:196-198
	Guide: https://docs.bridgecrew.io/docs/s3_16-enable-versioning

		196 | resource "aws_s3_bucket" "s3_bucket" {
		197 |   bucket_prefix = var.s3_bucket_prefix
		198 | }


